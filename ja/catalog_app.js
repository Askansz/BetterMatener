window.Catalog=new function(){"use strict";var n,u=!1,i=0,r=!1,t=function(){Catalog.contentLoaded||r||(r=!0,Catalog.loader.show(),Catalog.requester.getItems(Catalog.endpoints.allApps(Catalog.user.device.id(),Catalog.user.device.type()),function(){Catalog.contentLoaded=!0;Catalog.publisher.publish("Catalog.initialized");Catalog.ready(function(){var n=Catalog.utils.resolveDirectToItemGuid();Catalog.publisher.publish("Catalog.headerActionsToggle",!0);Catalog.publisher.publish("Catalog.resetMenuCounts");Catalog.publisher.publish("Catalog.showMainList");n&&Catalog.publisher.publish("Catalog.showDetails",n);Catalog.publisher.publish("Catalog.showEulasThatNeedAccepting")});Catalog.loader.hide();Catalog.user.isMamOnly()&&Catalog.utils.isAndroidDevice()&&!Catalog.storage.currentDevice.get("ANDROID_BOOKMARK_MESSAGE")&&(Catalog.modal.show(Catalog.localization.getLabel("AndroidBookmarkNotificationText")+'<div class="button_set"><button onclick="Catalog.modal.popContainer(this)">'+Catalog.localization.getLabel("Ok")+"<\/button><\/div>",{allowOverlayClickClose:!0}),Catalog.storage.currentDevice.set("ANDROID_BOOKMARK_MESSAGE",!0))},function(){Catalog.contentLoaded=!1;Catalog.loader.hide();Catalog.errors.anyOpenErrors()||Catalog.authenticationRequired?Catalog.publisher.publish("Catalog.initialized"):(i++,console.error("We were unable to retrive the items from the server this is attempt:",i),i<2?t():(Catalog.publisher.publish("Catalog.initialized"),Catalog.errors.throwError("server_connection")))}))};return{authenticationRequired:!1,contentLoaded:!1,isHideCommentsEnabled:!1,init:function(){if(u){console.error("init() should only be called once. Ignoring subsequent init()");return}if(u=!0,Catalog.loader.show(),!Catalog.utils.cookiesEnabled()){Catalog.publisher.publish("Catalog.initialized");Catalog.ready(function(){Catalog.errors.throwError("cookies_disabled")});return}Catalog.onlineState.whenOffline(function(){console.log("YOU ARE OFFLINE");Catalog.publisher.publish("Catalog.initialized");Catalog.loader.forceHide();Catalog.contentLoaded?n||(n=Catalog.notify.send(Catalog.localization.getLabel("WentOfflineNotification"),{persist:!0,appendingClass:"warn"})):Catalog.errors.throwError("offline");Catalog.publisher.publish("Catalog.offline")});Catalog.onlineState.onlineRecovered(function(){if(console.log("YOU ARE BACK ONLINE"),n?(Catalog.notify.remove(n),n=null):Catalog.errors.supressError("offline"),Catalog.publisher.publish("Catalog.onlineRecovered"),!Catalog.contentLoaded)Catalog.appCache.onCacheReady(t)});if(Catalog.onlineState.online())Catalog.appCache.onCacheReady(t);Catalog.loader.hide()},resumeInitialization:function(n){Catalog.onlineState.online()&&!Catalog.contentLoaded&&(n&&(r=!1),t())}}};Catalog.utils=function(n){"use strict";return{resolveDeviceIdentifier:function(){var n,t=function(){var t=window.location.pathname,n=t.split("/");return n.length>=3?n[3]:0};return function(){return n===undefined&&(n=t()),n?n:""}}(),resolveDeviceType:function(){var t,i,r=function(){var u=window.location.pathname,r=u.split("/"),t=r.length>=4?r[4].toLowerCase():"";return i=t,!parseInt(t,10)&&t in n.enums.deviceType&&(t=n.enums.deviceType[t]),t};return function(n){return(t===undefined&&(t=r()),n)?i?i:"":t?t:""}}(),resolveDirectToItemGuid:function(){var i,u,r,t;return(i=this.getHashParameter("guid"))?console.log("Redirect to item with guid",i):(u=this.getHashParameter("bundle")||this.getQueryParameter("id"))&&(r=this.getHashParameter("type")||this.getQueryParameter("type"),isNaN(r)&&(r=this.parseItemType(r.toLowerCase())),t=n.list.getItemsByField("bundleId",u),t.length>0&&(t=n.list.getItemsByField(t,"type",+r||n.enums.appType.internal)),t.length>0&&(i=t[0].guid,console.log("Redirect to item with guid",i))),i},isFullScreen:function(){return navigator&&!!navigator.standalone},cookiesEnabled:function(){var n=!1;return navigator.cookieEnabled?"cookie"in document&&(document.cookie.length>0?n=!0:(document.cookie="aw_cookie_test",n=document.cookie.indexOf("aw_cookie_test")>-1,document.cookie="")):n=!1,n},isMobileDevice:function(){var n=null;return function(){return n===null&&(n=/Mobile|Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/i.test(navigator.userAgent)),n}}(),isAndroidDevice:function(){var n=null;return function(){return n===null&&(n=/Android/i.test(navigator.userAgent)),n}}(),isMobileResolution:function(){var n=window.innerWidth>0?window.innerWidth:screen.width;return n<=750},createGuid:function(){var n=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},parseItemType:function(n){var t=0;if(n)switch(n.toLowerCase()){case"public":t=1;break;case"internal":t=2;break;case"purchased":t=3;break;case"web":t=4;break;case"customb2b":t=5;break;default:t=-1}return t},isEntitledItem:function(n){return n&&n.groups&&n.groups.indexOf("entitlement")>-1},sortAry:function(n,t,i,r){typeof t!="string"&&(r=i,i=t,t=null);typeof i!="boolean"&&(r=i,i=!1);var u=function(n){return typeof n=="object"?r?r(n[t]):n[t]:r?r(n):n};n.sort(function(n,t){var r=u(n),f=u(t);return(r<f?-1:r>f?1:0)*[-1,1][+!!i]})},primers:{stringPrimer:function(n){return n&&n.toUpperCase()||""},datePrimer:function(n){return new Date(n)}},isDecendent:function(n,t){for(var i=t.parentNode;i!=null;){if(i==n)return!0;i=i.parentNode}return!1},forEach:function(n,t,i){if(n)for(var r=0;r<n.length;r++)t.call(i,r,n[r])},deserialize:function(n){return n=n.substr(n.indexOf("?")+1),JSON.parse('{"'+decodeURI(n.replace(/&/g,'","').replace(/=/g,'":"'))+'"}')},serialize:function(n,t){var i=t?"?":"";for(var r in n)i+=r+"="+encodeURIComponent(n[r])+"&";return i.slice(0,-1)},getHashParameter:function(n){var t=location.hash.substring(1),i=t!==""?this.deserialize(t):{};return i[n]},getQueryParameter:function(n){if(location.href.indexOf("?")>-1){var t=location.href.substr(location.href.indexOf("?")+1),i=t!==""?this.deserialize(t):{};return i[n]}return undefined},createItemGuid:function(n){return n.id+"-"+n.type},getInstallButtonMessage:function(t){var i;switch(t){case"install":case 1:i=n.localization.getLabel("Install");break;case"pending":case 2:i=n.localization.getLabel("Processing");break;case"installed":case 3:i=n.localization.getLabel("Installed");break;case"error":case 4:i=n.localization.getLabel("Retry");break;case"updates":i=n.localization.getLabel("Update");break;case"activate":i=n.localization.getLabel("Activate")}return i},updateInstallButtonState:function(t,i){var e,r,u=n.enums.install,f=n.list.getItemByGuid(t);f&&f.activationUrl&&(i="activate");i==u.installed&&(i=f.groups.indexOf("updates")>-1?"updates":i);switch(i){case u.error:r="red";break;case u.pending:r="dark";break;case u.installed:r="green";break;case"updates":r="dark_blue"}e=document.querySelectorAll('[data-install-for="'+t+'"]');requestAnimationFrame(function(){n.utils.forEach(e,function(t,u){u.innerHTML=n.utils.getInstallButtonMessage(i);u.classList.remove("red","green","dark","dark_blue");u.classList.add(r)})})},getInstallationPromptMessage:function(t){var i;return t!==n.enums.installMessageType.Unknown?i=n.localization.getLabel(n.utils.getObjectKeyByValue(n.enums.installMessageType,t)):console.error("recieved an unknown installMessage type"),i||n.localization.getLabel("ArgUserInstallConfirmation")},getTypeMessage:function(t){var i;switch(t=t.length>1?t:parseInt(t,10)){case 1:i=n.localization.getLabel("Public");break;case 2:i=n.localization.getLabel("Internal");break;case 3:i=n.localization.getLabel("Purchased");break;case 4:i=n.localization.getLabel("Web");break;case 5:i=n.localization.getLabel("CustomB2B");break;case 6:i=n.localization.getLabel("Products");break;default:console.error("Received and invalid item type: ",t)}return i},getObjectKeyByValue:function(n,t){for(var i in n)if(n[i]===t)return i;return null},extend:function(n,t){for(var i in t)i!=="guid"&&t.hasOwnProperty(i)&&(n[i]=t[i]);return n},cleanString:function(n){return n.replace(/[|&;$%"<>()+,]/g,"")},openUrl:function(n,t){console.log("Opening url",n,t?"in a new tab":"in this same tab");t?window.open(n,"_blank"):window.location=n},removeArrayValues:function(n,t){for(var i,r;i=t.pop();)while((r=n.indexOf(i))>-1)n.splice(r,1);return n},click:function(n){var t=document.createEvent("MouseEvents");return t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(t)},scrollTo:function(t,i,r){if(r=r||0,!(r<0)){var a=16,e=i.y!=null&&!isNaN(i.y),s,h,u,o=i.x!=null&&!isNaN(i.x),c,l,f;(e||o)&&(e&&(u=t.scrollTop,s=i.y-u,h=s/r*10),o&&(f=t.scrollLeft,c=i.x-f,l=c/r*10),requestAnimationFrame(function(){e&&(u=t.scrollTop=u+h);u===Math.ceil(i.y)&&(i.y=null);o&&(f=t.scrollLeft=f+l);f===Math.ceil(i.x)&&(i.x=null);n.utils.scrollTo(t,i,r-a)}))}},getFirstTextNode:function(n){for(var r="",i,t=0;t<n.childNodes.length;t++)if(i=n.childNodes[t],i.nodeType===3){r=i.nodeValue.trim();break}return r}}}(Catalog);String.prototype.trim||function(){var n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(n,"")}}();Function.prototype.hasOwnProperty("bind")||(Function.prototype.bind=function(){for(var i=this,r=arguments[0],u=arguments.length,n=[],t=1;t<u;t++)n.push(arguments[t]);return function(t){return n.splice(0,0,t),i.apply(r,n)}});Catalog.errors=function(n){"use strict";var i=document.getElementById("fatal_errors"),t=0;return{throwError:function(r,u){var f;i.style.display="block";r==="cookies_disabled"?document.getElementById("cookies_disabled").style.display="block":r==="offline"?document.getElementById("offline").style.display="block":r==="server_connection"?document.getElementById("server_connection").style.display="block":r==="dynamic"&&(f=document.getElementById("dynamic_error_hook"),f.style.display="block",f.innerHTML=u);n.ready(function(){n.publisher.publish("Catalog.headerActionsToggle",!1);n.loader.forceHide()});t+=1;console.error(r,u||"")},supressError:function(n){i.style.display="";n==="cookies_disabled"?document.getElementById("cookies_disabled").style.display="":n==="offline"?document.getElementById("offline").style.display="":n==="dynamic"&&(document.getElementById("dynamic_error_hook").style.display="");t-=0},anyOpenErrors:function(){return t>0}}}(Catalog);Catalog.loader=function(){"use strict";var t=[],n=document.getElementById("loader");return{show:function(){t.length===0&&(n.classList.add("visible"),n.classList.remove("hidden"));t.push(1)},hide:function(){t.pop()&&t.length!==0||(n.classList.remove("visible"),n.classList.add("hidden"))},forceHide:function(){n.classList.remove("visible");n.classList.add("hidden");t=[]}}}();Catalog.onlineState=function(){"use strict";var n=function(){return navigator.onLine!==undefined?navigator.onLine:!0},t=[],i=[],r=function(n){for(var i=n.length,t=0;t<i;t++)n[t]()};return window.addEventListener("offline",function(){r(t)}),window.addEventListener("online",function(){r(i)}),{online:function(){return!!n()},whenOffline:function(i){t.push(i);n()||i()},onlineRecovered:function(n){i.push(n)}}}();Catalog.appCache=function(n,t){"use strict";var u=!1,i,f=[],o=function(n){n=n||"";for(var r=n.length,i=0;i<r;i++)n[i]();t.loader.hide()},r=function(){e();u=!0;o(f)},s=function(){try{n.swapCache()}catch(t){console.error(t)}e();window.location.reload()},e=function(){i&&(t.notify.remove(i),i=null)};return n?n.status===n.UNCACHED?r():(n.addEventListener("checking",function(){t.resumeInitialization(!1)}),n.addEventListener("noupdate",r),n.addEventListener("downloading",function(){i||(i=t.notify.send(t.localization.getLabel("UpdatingAppCatalogResources"),{persist:!0,appendingClass:"obtrusive"}))}),n.addEventListener("updateready",s),n.addEventListener("cached",r),n.addEventListener("obsolete",r),n.addEventListener("error",function(){e();console.error("App Cache threw a fatal error and we will allow the user to continue");r()})):(console.info("This device does not support window.applicationCache"),u=!0,o(f)),{onCacheReady:function(n){t.loader.show();u?(n(),t.loader.hide()):f.push(n)}}}(window.applicationCache,Catalog);Catalog.publisher=function(n){"use strict";var t={},i=0;return{publish:function(n,i){if(!t[n])return!1;for(var r=t[n],u=r?r.length:0;u--;)r[u].func(i,n)},subscribe:function(r,u){var f,e,o;if(r!==n&&u!==n){for(r=r.split(","),o=(++i).toString(),f=0;f<r.length;f++)e=r[f].trim(),t[e]||(t[e]=[]),t[e].push({token:o,func:u});return o}},unsubscribe:function(i,r){var f=function(n){for(var t=0;t<n.length;t++)n[t].token===i&&n.splice(t,1)},u;if(r!==n)f(t[r]);else for(u in t)t[u]&&f(t[u])}}}();Catalog.ready=function(n){"use strict";var u=!1,t=!1,i=!1,f=[],r=function(){t&&i&&(document.body.classList.add("catalog_ready"),u=!0,e())},e=function(){for(var t;t=f.shift();)t(n);n.loader.hide()};return document.readyState!=="complete"?document.onreadystatechange=function(){document.readyState==="complete"&&(t=!0,r())}:(t=!0,r()),n.publisher.subscribe("Catalog.initialized",function(){i||(i=!0,r())}),function(n){if(u){n();return}f.push(n)}}(Catalog);Catalog.storage=function(){"use strict";var u=function(n,t){try{return localStorage&&localStorage[n].apply(localStorage,t)}catch(i){return console.error("Could not preform operation with localStorage: ",n,"LocalStorage is not available when in private browsing mode."),""}},i="SESSION_SPACE",r="DEVICE_SPACE",o=new Date,s,n=null,f=function(){if(!n){var t=Catalog.storage.get(i);n=!t||t==""?{}:JSON.parse(t);s=n&&n.lastAccessTime&&new Date(n.lastAccessTime);n.lastAccessTime=o;Catalog.storage.set(i,JSON.stringify(n))}return n},t=null,e=function(){if(!t){var n=Catalog.storage.get(r);t=!n||n==""?{}:JSON.parse(n);t.identifier!==Catalog.utils.resolveDeviceIdentifier()&&(t={identifier:Catalog.utils.resolveDeviceIdentifier(),data:{}},Catalog.storage.set(r,JSON.stringify(t)))}return t};return{set:function(n,t){u("setItem",[n,t])},get:function(n){return u("getItem",[n])},remove:function(n){u("removeItem",[n])},empty:function(){u("clear")},currentSession:{set:function(t,r,u){f();n[t]={data:r,daysToKeep:u||1};Catalog.storage.set(i,JSON.stringify(n))},get:function(t){f();var r,i=n[t];if(i)return o-s>i.daysToKeep+864e5?Catalog.storage.currentSession.remove(t):r=i.data,r},remove:function(t){f();delete n[t];Catalog.storage.set(i,JSON.stringify(n))},empty:function(){Catalog.storage.remove(i)}},currentDevice:{set:function(n,t){var i=e();i.data[n]=t;Catalog.storage.set(r,JSON.stringify(i))},get:function(n){var t=e();return t.data[n]},remove:function(n){var t=e();n in t.data&&delete t.data[n];Catalog.storage.set(r,JSON.stringify(t))},empty:function(){Catalog.storage.remove(r)}}}}();Catalog.list=function(n){"use strict";var t={},i={};return{update:function(r){var u;if(r.guid)return r.categories&&n.utils.forEach(r.categories,function(n,t){i[t]=t}),r.type&&((r.type!==n.enums.appType.web||n.utils.isEntitledItem(r))&&r.type!==n.enums.appType.product||(r.detailsLoaded=!0),u=n.utils.getTypeMessage(r.type),i[u]=u),t[r.guid]=t[r.guid]===undefined?r:n.utils.extend(t[r.guid],r);console.error("Attempting to add an item with no guid: ",r)},updateRange:function(n){for(var i=[],t=0;t<n.length;t++)i.push(this.update(n[t]));return i},getAllItems:function(){var n,i=[];for(n in t)i.push(t[n]);return i},getItemByGuid:function(n){return t[n]},getItemsByGuids:function(n){for(var u=[],r,i=0;i<n.length;i++)r=n[i],t[r]&&u.push(t[r]);return u},getItemsByField:function(n,i,r,u){var o=0,s,f,h,e=[];n instanceof Array||(u=r,r=i,i=n,n=t);typeof r=="function"&&(u=r,r=undefined);for(s in n)if(f=n[s],f[i])if(r!==undefined)if(f[i]instanceof Array){for(h=f[i].length,o=0;o<h;o++)if(u!==undefined){if(u(r,f[i][o])){e.push(f);break}}else if(f[i][o]===r){e.push(f);break}}else u!==undefined?u(r,f[i])&&e.push(f):f[i]===r&&e.push(f);else u!==undefined?u(f[i])&&e.push(f):e.push(f);return e},getItemsCategories:function(){var t=[];for(var r in i)t.push(r);return n.utils.sortAry(t,!0),t}}}(Catalog);Catalog.user=function(n){"use strict";var t={},i;return n.storage.set("DEVICE_IDENTIFIER",n.utils.resolveDeviceIdentifier()),{update:function(i){t=n.utils.extend(t,i)},get:function(){return t},isMamOnly:function(){return t&&t.enrollType&&t.enrollType==="mam"},isManaged:function(){return t&&t.enrollType&&t.enrollType==="mdm"},getPinnedCategories:function(){var r;return i||(i=[],t.pinnedCategories&&t.pinnedCategories.length>0&&(r=n.list.getItemsCategories(),n.utils.forEach(t.pinnedCategories,function(n,t){r.indexOf(t)>-1&&i.indexOf(t)===-1&&i.push(t)}))),i},device:{id:function(){return n.utils.resolveDeviceIdentifier()},type:function(){return n.utils.resolveDeviceType()}},requiresAuthentication:function(){return t&&t.requiresAuthentication}}}(Catalog);Catalog.templates=function(n){"use strict";var t={};return n.ready(function(){var t=document.querySelectorAll('[data-pre-cache="true"]');n.utils.forEach(t,function(t,i){n.templates.preCacheTemplate(i.id)})}),{preCacheTemplate:function(n){var i=document.getElementById(n);return n in t||(t[n]=Handlebars.compile(i.innerHTML)),t[n]},getPopulatedHTML:function(t,i){var r=n.templates.preCacheTemplate(t);return r(i)}}}(Catalog);Catalog.installer=function(n){"use strict";var i,t=function(){var t={},i=2e4;return{prevent:function(n){t[n]={reason:null}},preventForSomeTime:function(n){t[n]={reason:"time",milliSincePrevented:new Date}},allowedToBeRequested:function(r){var u=t[r];return u?u.reason==="time"&&new Date-u.milliSincePrevented>i?(this.allow(r),!0):(n.notify.send(n.localization.getLabel("InstallRequestReceived")),!1):!0},allow:function(n){delete t[n]}}}(),u=function(u,f){var o=u.data,e=o.length>1&&o[1],s=o[0].installSuccessful,h=s&&o[0].installUrl;if(!s&&(!e||e.type==="Unknown")){console.error("We could send the request but it stated the install failed and offered no way to fix this situation. Likely a db issue or missing queues");r(u,f);t.allow(f.guid);return}if(s){t.preventForSomeTime(f.guid);i&&document.querySelector('[data-notif-guid="'+i+'"]')||(i=n.notify.send(n.localization.getLabel("InstallRequestReceived")));h?(console.info("Install successful, redirecting to install url: ",h),n.utils.openUrl(h)):console.info("Install successful, install was queued on backend for app: ",f.name);return}f.originalInstallState!==undefined&&(f.installState=f.originalInstallState,n.utils.updateInstallButtonState(f.guid,f.installState));e&&(t.allow(f.guid),e.type==="EULA"?(e.data.itemName=f.name,e.data.itemGuid=f.guid,n.publisher.publish("Catalog.requireEulaForInstall",e.data)):e.type==="Compliance"?n.modal.show(e.data.complianceMessage,{allowOverlayClickClose:!0}):e.type==="VPP"?n.publisher.publish("Catalog.presentManagedDistributionInvitation",e.data):e.type==="WNS"&&n.modal.show(e.data.wnsErrorMessage,{allowOverlayClickClose:!0}))},r=function(t,i){i.installState=n.enums.install.error;n.utils.updateInstallButtonState(i.guid,i.installState);n.authenticationRequired||(t.userMessage==="401"?n.notify.send(n.localization.getLabel("InstallRequestExpired"),{appendingClass:"warn"}):n.notify.send(n.localization.getLabel("InstallRequestFailed"),{appendingClass:"warn"}))},f=function(t){var i;return t.installationMessage?t.installationMessage:(i=n.utils.getInstallationPromptMessage(t.installMessageType),t.installationMessage=i)},e=function(t){return t.confirmedInstallationMessage||n.modal.show(n.templates.getPopulatedHTML("installation_confirmation_template",{installHeading:(t.installMessageType===n.enums.installMessageType.RedirectToWebAppDirectly?n.localization.getLabel("ContinueToArg"):n.localization.getLabel("InstallArg")).format(t.name),silentInstall:t.isSilent,price:(t.type===n.enums.appType.publicApp||t.type===n.enums.appType.internal)&&t.price,publicPaid:t.type===n.enums.appType.publicApp&&t.price,size:t.size,guid:t.guid,activationUrl:t.activationUrl,activationMessage:t.activationUrl&&n.localization.getLabel("ArgUserInstallAndActivationInfo").format(t.name),message:f(t).format(t.name),installButtonState:n.utils.getInstallButtonMessage(t.groups.indexOf("updates")>-1?"updates":"install")}),{modalContentClass:"auto_width"}),!t.confirmedInstallationMessage};return{install:function(i,f,o=0){var s=n.list.getItemByGuid(i),h=n.endpoints.installApp(n.utils.resolveDeviceIdentifier(),n.utils.resolveDeviceType(),s.id,s.type);if(!s)return!1;if(!n.onlineState.online())return n.modal.alert(n.localization.getLabel("OfflineInstallRequestAlert"),{allowOverlayClickClose:!0}),!1;if(!f&&e(s))return console.log("User needs to accept installation message"),!1;s.originalInstallState=s.installState;s.installState=n.enums.install.pending;n.utils.updateInstallButtonState(s.guid,s.installState);(o===1||t.allowedToBeRequested(s.guid))&&(t.prevent(s.guid),n.requester.post(h,{eulaId:s.eulaId,token:s.token},function(n){u(n,s)},function(t){o<1?(console.log("Retrying install request for guid: ",i),n.installer.install(i,f,o+1)):(console.error("Unable to send our install request to server. Server is either unreachable or an error occured on the server side."),console.log(t,s,i,h),r(t,s))},{type:"json"}))},confirmAndInstall:function(t){var i=n.list.getItemByGuid(t);i.activationUrl||(i.confirmedInstallationMessage=!0);n.installer.install(t)}}}(Catalog);Catalog.endpoints=function(n){var t={appsDump:"Apps/",appsSingle:"Apps/",installApp:"Apps/Install/",login:"Auth/",logout:"Auth/",submitAppReview:"Apps/Reviews/",eula:"Apps/Eula/",samlAuthentication:"SAML/"};return{authenticate:function(i,r){return n.baseUrl+t.login+i+"/"+r},unauthenticate:function(){return n.baseUrl+t.logout},allApps:function(i,r){return n.baseUrl+t.appsDump+i+"/"+r},singleApp:function(i,r,u,f){return n.baseUrl+t.appsSingle+i+"/"+r+"/"+u+"/"+f},installApp:function(i,r,u,f){return n.baseUrl+t.installApp+i+"/"+r+"/"+u+"/"+f},postReview:function(i,r,u,f){return n.baseUrl+t.submitAppReview+i+"/"+r+"/"+u+"/"+f},eula:function(i,r){return n.baseUrl+t.eula+i+"/"+r},samlAuthenticationRedirect:function(i,r){return n.baseUrl+t.samlAuthentication+i+"/"+r}}}(Catalog);Catalog.requester=new function(){"use strict";var n={},t=function(n){Catalog.performance.clearMarks("REQUEST:sent:"+n)},i=function(n,i,r,u){var f,u=u||{},e=n.xhr;if(!(e.readyState<4)){if(e.status!==200){t(n.requestURL);console.error("Requester XHR responded: ",e.status,e.statusText);r&&r();return}if(e.readyState===4){if(f=u.type&&u.type.toLowerCase()==="json"?JSON.parse(e.responseText):e.responseText,t(n.requestURL),f&&f.developerMessage&&f.developerMessage!==""&&console.info(f.developerMessage),f.statusCode===401||f.code===401){Catalog.publisher.publish("Catalog.requestAuthentication",f.data);r&&r(f);return}if(f.statusCode===400||f.code===400){Catalog.errors.throwError("dynamic",f.userMessage);r&&r(f);return}i&&i(f)}}};return{post:function(n,t,r,u,f){var e=new XMLHttpRequest,o={xhr:e,requestURL:n};typeof t=="function"&&(f=u,u=r,r=t);e.onreadystatechange=function(){i(o,r,u,f)};e.open("POST",n,!0);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");Catalog.performance.mark("REQUEST:sent:"+n);e.send(Catalog.utils.serialize(t))},get:function(n,t,r,u){var e={},f=new XMLHttpRequest,o={xhr:f,requestURL:n};typeof t=="function"?(u=r,r=t):r!==undefined&&(e=t);f.onreadystatechange=function(){i(o,r,u,e)};f.open("GET",n,!0);Catalog.performance.mark("REQUEST:sent:"+n);f.send()},getJSON:function(n,t,i){this.get(n,{type:"json"},t,i)},getItems:function(t,i,r){var u,f=[],e;if(t in n){i(Catalog.list.getItemsByGuids(n[t]));return}this.getJSON(t,function(r){for(f=r.data[0]&&r.data[0].items,n[t]=[],u=0;u<f.length;u++)e=f[u],e.guid=Catalog.utils.createItemGuid(e),n[t].push(e.guid);r.data[0]&&r.data[0].user&&Catalog.user.update(r.data[0].user);i(Catalog.list.updateRange(f))},r)},getItem:function(n,t,i,r,u,f){Catalog.requester.getItems(Catalog.endpoints.singleApp(n,t,i,r),u,f)}}};Catalog.notify=function(){"use strict";var t=6e3,n=document.getElementById("notifications"),i=new Delegate(n);i.on("click","li.closable",function(){this.parentElement.removeChild(this)});return{send:function(i,r){r=r||{};var f=Catalog.utils.createGuid(),e,u={persist:!!r.persist,appendingClass:r.appendingClass||"",closeCallback:r.closeCallback};if(!i){console.error("You must provide a message in order to notify the user");return}return e=Catalog.templates.getPopulatedHTML("notify_item_template",{message:new Handlebars.SafeString(i),guid:f,appendingClass:u.appendingClass,persist:u.persist}),n.insertAdjacentHTML("beforeEnd",e),e=n.querySelector('[data-notif-guid="'+f+'"]'),u.persist||setTimeout(function(){Catalog.notify.remove(f);u.closeCallback&&u.closeCallback()},t),setTimeout(function(){e.className+=" opened "},20),f},remove:function(t){var i=n.querySelector('[data-notif-guid="'+t+'"]');i&&n.removeChild(i)}}}();Catalog.touch=function(n){"use strict";var i=Hammer(document.body,{drag_min_distance:20,hold:!1,tap:!1,transform:!1}),t={dragging:!1,defaultPrevented:!1},r=function(){var r=[],f=0,u=0,e=!1,o=function(n){var i=n.gesture.deltaX;t.dragging=!0;u=i;e||(e=!0,requestAnimationFrame(function(){var i,o=u-f;if(t.dragging&&(o>1||o<-1)){for(i=0;i<r.length;i++)r[i].swiping(u,n.srcElement);f=u}e=!1}))},s=function(n){o(n)},h=function(n){o(n)},c=function(n){var i,u=n.gesture.deltaX;f=0;requestAnimationFrame(function(){for(i=0;i<r.length;i++)r[i].swipeEnd(u,n.srcElement);t.dragging=!1;t.defaultPrevented=!1})};i.on("swipeleft swiperight dragleft dragright dragend dragup dragdown",function(n){t.defaultPrevented&&n.gesture.preventDefault();n.gesture.stopPropagation();n.type==="swipeleft"||n.type=="dragleft"?s(n):n.type==="swiperight"||n.type=="dragright"?h(n):c(n)});return function(t,i){if(n.utils.isAndroidDevice()){console.info("Swipping currently not available for Android devices");return}t&&i||console.error("Please provide both a swipe callback and a swipe end callback");n.utils.isMobileDevice()&&r.push({swiping:t,swipeEnd:i})}}(),u=function(){t.defaultPrevented=!0};return{swipeHandler:r,preventDefault:u}}(Catalog);Catalog.enums={install:{unknown:0,notInstalled:1,pending:2,installed:3,error:4},deviceType:{unknown:0,apple:2,android:5,appleosx:10,windowsphone8:11,winrt:12},appType:{unknown:0,publicApp:1,internal:2,purchased:3,web:4,customb2b:5,product:6},authType:{unknown:0,forms:1,token1factor:2,token2factor:3},keyCode:{tab:9},installMessageType:{unknown:0,GenericMarketplaceRedirection:1,GenericMessageForSilentInstall:2,BookmarkCreationForInstall:3,TakenOutOfCatalogInstallStartOnHome:4,PromptedForInstallByOsThenTakenHome:5,InstructGoToAgentNotifications:6,AgentNotificationRedirection:7,InstructToGoToDownloadsFolder:8,ProfileInstallPrompt:9,RedirectToWebAppDirectly:10}};Catalog.authentication=function(n){var i=!1,t=n.storage.get("FAILED_AUTHENTICATION_ATTEMPTS")||0,r=function(){n.publisher.publish("Catalog.showLogin")};return n.publisher.subscribe("Catalog.requestAuthentication",function(t){var u,f;t?(u=(t.length>1?t[1]:t[0]).authType,f=t.length>1?t[0].loginAttemptFailed:!1):u=n.user.get().authenticationType;n.authenticationRequired=!0;n.authenticationType=n.enums.authType[u];u==="saml"&&n.publisher.publish("Catalog.SAMLAuthenticate");i?r():n.ready(function(){i=!0;r()});f&&n.publisher.publish("Catalog.showLoginError")}),n.publisher.subscribe("Catalog.requestToUnauthenticate",function(){n.requester.post(n.endpoints.unauthenticate(),{encryptedUid:n.utils.resolveDeviceIdentifier(),deviceType:n.utils.resolveDeviceType()},function(){console.log("User logged out successfully")},{type:"json"})}),n.publisher.subscribe("Catalog.successfulAuthentication",function(){n.authenticationRequired=!1;t=0;n.publisher.publish("Catalog.hideLogin");n.contentLoaded?(n.publisher.publish("Catalog.resetMenuCounts"),n.publisher.publish("Catalog.headerActionsToggle",!0)):n.resumeInitialization(!0)}),n.publisher.subscribe("Catalog.failedAuthentication",function(){t++;n.storage.set("FAILED_AUTHENTICATION_ATTEMPTS",t);console.error("Login attempt failed! Number of attempts:",t);n.publisher.publish("Catalog.showLoginError")}),n.publisher.subscribe("Catalog.SAMLAuthenticate",function(){console.info("We require saml authentication so we need to redirect to the appropriate SAML Authority");window.location=n.endpoints.samlAuthenticationRedirect(n.utils.resolveDeviceIdentifier(),n.utils.resolveDeviceType())}),{sendCredentials:function(t,i,r,u){n.requester.post(n.endpoints.authenticate(n.utils.resolveDeviceIdentifier(),n.utils.resolveDeviceType()),{username:t,password:i,token:r},function(){u(!0);n.publisher.publish("Catalog.successfulAuthentication")},function(){n.authenticationRequired=!0;u(!1);n.publisher.subscribe("Catalog.failedAuthentication")},{type:"json"})}}}(Catalog);Catalog.modal=function(n){"use strict";var i=[],f=0,t=null,r=function(r,u){u=u||{};var o=document.createDocumentFragment(),e=document.createElement("div"),s=n.utils.createGuid(),c=u.modalContentClass?u.modalContentClass:"",h=f++;return i.push(h.toString()),e.innerHTML=r,e.setAttribute("class","modal_content "+c),e.setAttribute("data-modal-stack-index",h),e.setAttribute("data-modal-guid",s),u.allowOverlayClickClose&&e.setAttribute("data-allow-overlay-click-close",u.allowOverlayClickClose),o.appendChild(e),t||(t=document.getElementById("modals_container")),t.appendChild(o),i.length===1&&(t.className="overlayed"),s},u=function(){return i[i.length-1]};return n.ready(function(){var i=new Delegate(document.getElementById("modals_container"));i.on("click",".modal_content",function(n){return n.stopPropagation(),!1});i.on("click",function(){var i=t.querySelector('[data-modal-stack-index="'+u()+'"]');i&&i.hasAttribute("data-allow-overlay-click-close")&&n.modal.pop()})}),{show:function(n,t){return r(n,t)},alert:function(t,i){var u='<div class="button_set"><button onclick="Catalog.modal.popContainer(this);" class="primaryBrandBackground primaryBrandBorder">'+n.localization.getLabel("Ok")+"<\/button><\/div>";return r(t+u,i)},pop:function(n){var r,f;r=n!==undefined?t.querySelector('[data-modal-guid="'+n+'"]'):t.querySelector('[data-modal-stack-index="'+u()+'"]');f=r.getAttribute("data-modal-stack-index");t.removeChild(r);i.splice(i.indexOf(f),1);i.length===0&&(t.className="")},popContainer:function(n){for(var t=n.parentNode,i;t!=null&&(i=t.getAttribute("data-modal-guid"))==null;)t=t.parentNode;t!=null&&i!=null&&this.pop(i)}}}(Catalog);Catalog.lazyload=function(n){var t="data-lazy-img-src",i="data-lazy-loaded",r="img["+t+"]";return{loadForContext:function(u){if(u){var f=u.querySelectorAll(r);n.utils.forEach(f,function(n,r){var f,u,e=function e(){r.src=this.src;r.setAttribute(i,"true");u.removeEventListener("load",e);u=null};r.hasAttribute(i)||(f=r.getAttribute(t),u=document.createElement("img"),u.addEventListener("load",e),u.src=f)})}}}}(Catalog);Catalog.performance=function(n){"use strict";var t={},i=function(){return(new Date).getTime()};return{now:i,mark:function(n){t[n.trim()]=i()},clearMarks:function(){n.utils.forEach(arguments,function(n,i){i=i.trim();t.hasOwnProperty(i)&&delete t[i]})},timeSinceMark:function(n,r){var u=t[n.trim()];return r===undefined&&(r=i()),u===undefined?-1:r-u}}}(Catalog);Catalog.localization=new function(){"use strict";var t="L18N",i="data-i18n",n={};return{getBundle:function(){return n||(n=JSON.parse(Catalog.storage.get(t))),n},setBundle:function(i){var r=JSON.stringify(i);n=i;Catalog.storage.set(t,r)},getLabel:function(i){return i?(n||(n=JSON.parse(Catalog.storage.get(t))),i in n)?n[i]:(console.info("Key not in localization bundle: ",i),i):undefined},getKey:function(i){var r;if(!i)return undefined;n||(n=JSON.parse(Catalog.storage.get(t)));for(r in n)if(n.hasOwnProperty(r)&&n[r]===i)return r;return console.info("value not found in localization bundle: ",i),i},localize:function(n){var r,t,o,f,s,u=!1,e;for(n=n||document,s=Array.prototype.slice.call(n.querySelectorAll("["+i+"]"));t=s.pop();){for(o=t.childNodes.length,u=!1,e=Catalog.localization.getLabel(t.getAttribute(i)),r=0;r<o&&!u;r++)f=t.childNodes[r],f.nodeType===3&&(f.data=e,u=!0);u||t.insertAdjacentHTML("afterbegin",e)}}}};Catalog.ready(function(n){new Delegate(document).on("click","a",function(n){if(!this.classList.contains("native_open"))return n.preventDefault(),!1});document.addEventListener("keydown",function(t){if(t.keyCode===n.enums.keyCode.tab&&(!document.activeElement||!document.activeElement.hasAttribute("data-allow-tab")))return t.preventDefault(),!1});navigator.standalone||setTimeout(function(){window.scrollTo(0,1)},4),function(){var i=null,t=!1,u=document.querySelectorAll("input[type=text], input[type=password], textarea"),r=function(){t=!0;setTimeout(function(){t=!1},6e4)};n.utils.forEach(u,function(n,t){t.addEventListener("focus",r,!1);t.addEventListener("blur",r,!1)});window.addEventListener("resize",function(){i!=null&&clearTimeout(i);i=setTimeout(function(){t||(t=!1,n.publisher.publish("Catalog.resize"))},100)})}(),function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}();Array.prototype.indexOf||(Array.prototype.indexOf=function(n,t){if(this===undefined||this===null)throw new TypeError('"this" is null or not defined');var i=this.length>>>0;for(t=+t||0,Math.abs(t)===Infinity&&(t=0),t<0&&(t+=i,t<0&&(t=0));t<i;t++)if(this[t]===n)return t;return-1});String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,i){return typeof n[i]!="undefined"?n[i]:t})}),function(){function t(n){var r,t;for(this.el=n,r=n.className.replace(/^\s+|\s+$/g,"").split(/\s+/),t=0;t<r.length;t++)i.call(this,r[t])}function f(n,t,i){Object.defineProperty?Object.defineProperty(n,t,{get:i}):n.__defineGetter__(t,i)}if(typeof Element!="undefined"&&!("classList"in document.documentElement)){var n=Array.prototype,i=n.push,r=n.splice,u=n.join;t.prototype={add:function(n){this.contains(n)||(i.call(this,n),this.el.className=this.toString())},contains:function(n){return this.el.className.indexOf(n)!=-1},item:function(n){return this[n]||null},remove:function(n){if(this.contains(n)){for(var t=0;t<this.length;t++)if(this[t]==n)break;r.call(this,t,1);this.el.className=this.toString()}},toString:function(){return u.call(this," ")},toggle:function(n){return this.contains(n)?this.remove(n):this.add(n),this.contains(n)}};window.DOMTokenList=t;f(Element.prototype,"classList",function(){return new t(this)})}}();document.body.classList.add(n.utils.resolveDeviceType(!0));document.getElementById("logo").addEventListener("click",function(t){document.body.classList.contains("aw_logs")&&(n.modal.alert(n.templates.getPopulatedHTML("console_info_prompt_template",{uid:n.utils.resolveDeviceIdentifier(),deviceType:{enumVal:n.utils.resolveDeviceType(),stringVal:n.utils.resolveDeviceType(!0)},cookiesEnabled:n.utils.cookiesEnabled,requiresAuth:n.authenticationRequired||n.user.requiresAuthentication(),logs:window.consoleLogStack(),timeForCatalogInit:n.timeToInit,timeToCompleteInit:n.timeToCompleteInit}),{allowOverlayClickClose:!0}),t.stopPropagation())})});Catalog.ready(function(n){"use strict";var i=document.getElementById("list_view"),u=new Delegate(i),t=i.querySelector(".view_body"),f=!0,r,e=function(t){var u=document.querySelector(".view.opened"),r=document.querySelector("#catalog_groups .current");t||(t=r&&n.utils.getFirstTextNode(r));t&&t==="Featured"?n.publisher.publish("Catalog.showFeaturedList"):(u.classList.remove("opened"),i.classList.add("opened"))},o=function(){if(r=r||i.querySelector(".selected"),!n.utils.isMobileResolution()){var f=t.scrollTop,o=f+t.offsetHeight,u=r.offsetTop,e=u+r.offsetHeight;u<f?n.utils.scrollTo(t,{y:u-30},200):e>o&&n.utils.scrollTo(t,{y:e-t.offsetHeight},200)}},s=function(){var o,t={items:[],filter:"",showMeta:!1,metaProperty:"",sortOrderDialog:""},r=document.querySelector(".catalog_categories .current"),h,u=document.querySelector("#catalog_groups .current"),s=document.querySelector(".catalog_sort select").value,c=document.querySelector('.catalog_sort select option[value="'+s+'"]'),l=!!(c&&c.getAttribute("data-show-meta")),a="";r=r?r.getAttribute("data-category"):null;u=u?u.classList.contains("all_of_type")?"All":u.getAttribute("data-groups"):null;r?(t.items=n.list.getItemsByField("categories",r),t.items.length===0&&(r=n.localization.getKey(r),(h=n.utils.parseItemType(r))>-1&&(t.items=n.list.getItemsByField("type",r,function(n,t){return t===h})))):t.items=u&&u!=="All"?n.list.getItemsByField("groups",u.toLowerCase()):n.list.getAllItems();t.filter=n.localization.getLabel(u)||r;t.sortOrder=s;t.showMeta=l;n.utils.sortAry(t.items,"name",!0,n.utils.primers.stringPrimer);switch(s.toLowerCase()){case"name a-z":t.sortOrderDialog=n.localization.getLabel("NameAZ");break;case"name z-a":t.sortOrderDialog=n.localization.getLabel("NameZA");n.utils.sortAry(t.items,"name",!1,n.utils.primers.stringPrimer);break;case"creator a-z":t.metaProperty="creator";t.sortOrderDialog=n.localization.getLabel("CreatorAZ");n.utils.sortAry(t.items,t.metaProperty,!0,n.utils.primers.stringPrimer);break;case"creator z-a":t.metaProperty="creator";t.sortOrderDialog=n.localization.getLabel("CreatorZA");n.utils.sortAry(t.items,t.metaProperty,!1,n.utils.primers.stringPrimer);break;case"not installed":t.sortOrderDialog=n.localization.getLabel("NotInstalled");n.utils.sortAry(t.items,"installState",!0);break;case"installed":t.sortOrderDialog=n.localization.getLabel("Installed");n.utils.sortAry(t.items,"installState",!1);break;case"date added":default:t.metaProperty="dateAdded";t.sortOrderDialog=n.localization.getLabel("DateAdded");n.utils.sortAry(t.items,t.metaProperty,!1,n.utils.primers.datePrimer)}for(o=0;o<t.items.length;o++)a+=n.templates.getPopulatedHTML("catalog_list_item_template",{item:t.items[o],showMeta:l,metaProperty:t.metaProperty,isReviewable:t.items[o].type!==n.enums.appType.web&&t.items[o].type!==n.enums.appType.product,isWebApp:t.items[o].type===n.enums.appType.web});return document.querySelector("#list_view .view_heading").innerHTML=n.templates.getPopulatedHTML("catalog_list_heading_template",t),document.querySelector("#list_view ul").innerHTML=a,t.items.length===0?(document.querySelector(".all_results_loaded").style.display="none",document.querySelector(".no_results").style.display="block",n.list.getAllItems().length===0?(document.querySelector('.no_results [data-no-results-reason="no_assignments"]').style.display="block",document.querySelector('.no_results [data-no-results-reason="empty_filter"]').style.display="none"):(document.querySelector('.no_results [data-no-results-reason="no_assignments"]').style.display="none",document.querySelector('.no_results [data-no-results-reason="empty_filter"]').style.display="block")):document.querySelector(".no_results").style.display="none",n.publisher.publish("Catalog.hideDetails"),f?f=!1:(document.querySelector(".main_list .view_heading").classList.add("emphasize"),setTimeout(function(){document.querySelector(".main_list .view_heading").classList.remove("emphasize")},1e3)),n.lazyload.loadForContext(i),e(u),t};n.publisher.subscribe("Catalog.showMainList",s);n.publisher.subscribe("Catalog.back, Catalog.home",function(){var n=t.querySelector(".selected");n&&n.classList.remove("selected");e()});u.on("click",".catalog_item_list a",function(){var u=this.getAttribute("data-guid"),t=this.parentNode,i;return t.classList.contains("selected")||((i=t.parentNode.querySelector(".selected"))&&i.classList.remove("selected"),t.classList.add("selected"),r=t,n.publisher.publish("Catalog.showDetails",u)),n.utils.isMobileResolution()||setTimeout(o,250),!1});u.on("click",".catalog_item_list button",function(){var t=this.getAttribute("data-install-for");return n.installer.install(t),!1});t.addEventListener("scroll",function(){var t=this.scrollTop+this.clientHeight,r=this.scrollHeight,i=r-t,n;i<=0?(n=document.querySelector(".all_results_loaded"),n.hasAttribute("data-show-loaded")||setTimeout(function(){this.scrollTop=t;n.setAttribute("data-show-loaded","true");n.classList.add("grow")},250)):i>50&&(n=document.querySelector(".all_results_loaded"),n.hasAttribute("data-show-loaded")&&(n.classList.remove("grow"),n.removeAttribute("data-show-loaded")))})});Catalog.ready(function(n){var t=document.getElementById("details_view"),i=new Delegate(t),u=document.getElementById("page_container"),r=document.getElementById("unable_to_load_details"),f=0,e=function(){var i=t.querySelectorAll(".collapsible_content");n.utils.forEach(i,function(n,t){var u=t.offsetHeight,i=t.parentNode,f=i.offsetHeight,r=i.parentNode.querySelector(".collapsible_toggles");i.classList.contains("showing_more")||(u>f?(i.classList.add("collapsed"),r.classList.remove("hidden"),r.classList.add("visible")):(i.classList.remove("collapsed"),r.classList.add("hidden"),r.classList.remove("visible")))})},s=function(i){var f=n.list.getItemByGuid(i),e="",o=function(){t.querySelector(".details_heading").innerHTML=e},s=document.querySelector("#details_view.opened .item_summary");return f?s&&s.getAttribute("data-guid")===i?f:(n.loader.forceHide(),n.loader.show(),r.classList.remove("visible"),r.classList.add("hidden"),t.querySelector(".details_body").style.display="none",u.classList.add("details_open"),e=n.templates.getPopulatedHTML("details_header_template",{item:f,isReviewable:f.type!==n.enums.appType.web&&f.type!==n.enums.appType.product,isWebApp:f.type===n.enums.appType.web}),t.classList.contains("opened")?(t.classList.add("fade_out"),requestAnimationFrame(function(){o();t.classList.remove("fade_out");t.querySelector(".view_body").scrollTop=0})):(o(),t.classList.add("opened"),t.querySelector(".view_body").scrollTop=0),f):(n.publisher.publish("Catalog.hideDetails"),!1)},o=function(i){if(f===i.guid){var r="",u="",o="",c=function(){t.querySelector(".view_body .detail_info_container").innerHTML=r;t.querySelector(".reviews_list_container").innerHTML=u;t.querySelector(".support_container").innerHTML=o},s=!1,h=i.type!==n.enums.appType.web&&i.type!==n.enums.appType.product;n.utils.forEach(i.reviews,function(t,i){(i.currentUser=i.userId===n.user.get().id)&&(s=!0)});i.description&&(i.description=i.description.replace(/(?:\r\n|\r|\n)/g,"<br />"));r=n.templates.getPopulatedHTML("details_body_template",i);u=n.templates.getPopulatedHTML("details_reviews_template",{reviewable:h,reviews:i.reviews});o=n.templates.getPopulatedHTML("details_support_template",i.support&&(i.support.email||i.support.phone)?i.support:null);c();!h||s||(i.installState===n.enums.install.notInstalled||i.installState===n.enums.install.error)&&n.user.isManaged()?t.querySelector(".leave_review").style.display="none":(n.publisher.publish("Catalog.resetReviewForm"),t.querySelector(".leave_review").style.display="block");t.querySelector(".details_body").style.display="block";n.loader.hide();n.lazyload.loadForContext(document.querySelector(".screenshots"));e()}},h=function(t,i,u,f){n.requester.getItem(t,i,u,f,function(t){var i=t.length>0?t[0]:{};i.detailsLoaded?(n.utils.updateInstallButtonState(i.guid,i.installState),o(i)):console.error("Fetched Details did not indicate the item.detailsLoaded")},function(){r.classList.remove("hidden");r.classList.add("visible");n.loader.hide()})};n.publisher.subscribe("Catalog.showDetails",function(t){var i;if(!t){n.publisher.publish("Catalog.hideDetails");console.error("GUID parameter can not be null or undefined. Ignoring request to show details");return}f=t;i=s(t);i||(console.error("Tried to open item but the item was not found for guid: "+t,"Send user to main list."),n.publisher.publish("Catalog.showMainList"));document.getElementById("menu_action").classList.contains("hidden")||document.getElementById("menu_action").classList.add("hidden");document.getElementById("back_action").classList.remove("hidden");i&&i.detailsLoaded?o(i):h(n.user.device.id(),n.user.device.type(),i.id,i.type)});n.publisher.subscribe("Catalog.hideDetails",function(){n.loader.forceHide();u.classList.remove("details_open");t.classList.contains("opened")&&document.querySelector("#details_view.opened").classList.remove("opened");n.publisher.publish("Catalog.back")});n.publisher.subscribe("Catalog.userAddedReview",function(i){var r=n.templates.getPopulatedHTML("details_reviews_template",{reviewable:!0,reviews:i.reviews});t.querySelector(".reviews_list_container").innerHTML=r;n.utils.click(document.querySelector(".reviews_list_container .show_more"))});n.publisher.subscribe("Catalog.home, Catalog.back, Catalog.showMainList",function(){t.classList.contains("opened")&&(n.loader.forceHide(),t.classList.remove("opened"),u.classList.remove("details_open"))});n.publisher.subscribe("Catalog.resize",function(){e()});i.on("click",".show_more, .show_less",function(n){var i=n.target,t=i.parentNode,r=t.parentNode.querySelector(".collapsible");i.classList.contains("show_more")?(r.classList.remove("collapsed"),r.classList.add("showing_more"),t.querySelector(".show_less").style.display="block",t.querySelector(".gradient").style.display="none",i.style.display="none"):(r.classList.remove("showing_more"),r.classList.add("collapsed"),t.querySelector(".show_more").style.display="block",t.querySelector(".gradient").style.display="block",i.style.display="none")});i.on("click",".catalog_item_list button",function(){var t=this.getAttribute("data-install-for");return n.installer.install(t),!1});i.on("click",".screenshots img",function(t){var u=[],i="",f='<div class="screenshots_popup">',o=this.getAttribute("src"),r=0,e="";return n.utils.forEach(document.querySelectorAll("#details_view .screenshots img"),function(n,t){i=t.getAttribute("src");u.push(i);i===o&&(r=n)}),f+=Handlebars.helpers.screenshotsHelper(u).string+"<\/div>",e=n.modal.show(f,{allowOverlayClickClose:!0}),requestAnimationFrame(function(){var t=document.querySelector("#modals_container .screenshots_popup"),u=t.offsetWidth,i=t.querySelector("img").offsetWidth;n.utils.scrollTo(t,{x:(i+12)*r-(u-i)/2},200);console.info("Scroll to screenshot index:",r,"of modal with guid:",e)}),t.stopPropagation(),!1});i.on("click",".details_heading .rating",function(){var r=t.querySelector(".view_body"),i=t.querySelector(".detail_info_container");n.utils.scrollTo(r,{y:i.scrollTop+i.offsetHeight},200)})});Catalog.ready(function(n){var t=document.querySelector(".leave_review"),r=new Delegate(document.getElementById("details_view")),u=function(t){var i=0;return n.utils.forEach(t.reviews,function(n,t){i+=parseInt(t.rating,10)}),i/t.reviews.length},i=function(i,r,u,f){var e=t.querySelectorAll(".rating_input_area a");t.querySelector(".overlay").style.display="none";t.querySelector("form input#review_rating").value=i;t.querySelector("form input#user_rating_id").value=u||0;n.utils.forEach(e,function(n,t){i-->0?t.classList.add("highlight"):t.classList.remove("highlight")});t.querySelector("textarea").value=r;t.querySelector("form").style.display=f?"block":"none";t.querySelector("textarea").style.display=n.isHideCommentsEnabled==="True"?"None":"block";t.style.display="block"},f=function(){var r,o=document.querySelector("#details_view.opened [data-guid]").getAttribute("data-guid"),s=t.querySelector("input#review_rating").value,h=t.querySelector("textarea").value,l=t.querySelector("input#user_rating_id").value||0,f=new Date,a=f.getUTCMonth()+1+"/"+f.getUTCDate()+"/"+f.getUTCFullYear().toString().substring(2),e={rating:s,comments:h,userId:n.user.get().id,date:a,currentUser:!0,userRatingId:0},i=n.list.getItemByGuid(o),c=!1;n.requester.post(n.endpoints.postReview(n.user.device.id(),n.user.device.type(),i.id,i.type),{UserId:n.user.get().id,Rating:s,Comments:h,UserRatingId:l,Token:i.token},function(f){var s=0;for(t.style.display="none",e.userRatingId=f.data[0].userRatingId,r=0;r<i.reviews.length;r++)if(i.reviews[r].currentUser){i.reviews[r]=e;c=!0;break}c||i.reviews.unshift(e);s=u(i);i.rating=s;n.utils.forEach(document.querySelectorAll('[data-guid="'+o+'"] .rating'),function(n,t){t.innerHTML=Handlebars.helpers.ratingStarsHelper(s).string});n.publisher.publish("Catalog.userAddedReview",i)},function(i){i.userMessage==="400"&&n.notify.send(n.localization.getLabel("ReviewRequestExpired"),{appendingClass:"warn"});console.error("Unable to submit review");t.querySelector(".overlay").style.display="none"},{type:"json"})};t.querySelector("form").addEventListener("submit",function(n){return t.querySelector(".overlay").style.display="block",f(),n.preventDefault(),!1});r.on("click",".rating_input_area a",function(){var i=!1,r=this,u=document.querySelectorAll(".rating_input_area a");return n.utils.forEach(u,function(t,u){i?u.classList.remove("highlight"):u.classList.add("highlight");u===r&&(i=!0,document.querySelector(".leave_review form input#review_rating").value=n.utils.getFirstTextNode(u))}),t.querySelector("form").style.display="block",t.querySelector("textarea").style.display=n.isHideCommentsEnabled==="True"?"None":"block",!1});t.querySelector("form input.cancel").addEventListener("click",function(){var n;return document.querySelector(".review_list li.current_user")?t.style.display="none":(i(0,"",0,!1),n=document.querySelector(".leave_review form textarea"),n.value="",n.blur()),!1});n.publisher.subscribe("Catalog.resetReviewForm",function(){i(0,"",0,!1)});r.on("click",".edit_review",function(){var u=document.querySelector(".review_list li.current_user"),r=document.getElementById("details_view"),e=r.querySelector(".view_body"),f;return i(u.querySelector(".rating").getAttribute("data-rating"),n.utils.getFirstTextNode(u.querySelector(".review")),u.getAttribute("data-user-rating-id"),!0),f=r.querySelector(".details_body").offsetHeight-(r.querySelector(".support_container").offsetHeight+r.querySelector(".reviews_list_container").offsetHeight+t.offsetHeight),n.utils.scrollTo(e,{y:f},200),!1})});Catalog.ready(function(n){"use strict";var t=document.querySelector("nav"),i=new Delegate(t),r=document.getElementById("menu_action"),u=function(){n.publisher.publish("Catalog.showMainList");n.publisher.publish("Catalog.sliders.close");document.querySelector(".main_list .view_body").scrollTop=0},e=function(t,i){var r=[],u=[],f=i&&i.length>0;return n.utils.forEach(t,function(n,t){f&&i.indexOf(t)>=0?u.push({name:t,pinned:!0}):r.push({name:t})}),u.concat(r)},o=function(){var t=n.storage.currentDevice.get("SORT_PREFERENCE");return t||(t=n.user.get().defaultSort),t},s=function(){var r=n.list.getItemsByField("groups","featured"),t,i;return n.list.getItemByGuid(n.utils.resolveDirectToItemGuid())!==undefined?null:(t=n.storage.currentSession.get("LAST_VIEWED_GROUPING"))?t:(i=n.user.get().defaultGroup)?i:"All"},f=function(){t.classList.contains("opened")?(t.classList.remove("opened"),t.querySelector("select").setAttribute("disabled","disabled"),r.classList.remove("opened","branded-nav-bg","branded-nav-item"),n.publisher.publish("Catalog.slider.closed")):(n.publisher.publish("Catalog.sliders.close"),t.scrollTop=0,t.classList.add("opened"),t.querySelector("select").removeAttribute("disabled"),r.classList.add("opened","branded-nav-bg","branded-nav-item"),n.publisher.publish("Catalog.slider.opened"))};n.publisher.subscribe("Catalog.resetMenuCounts",function(){var u=n.list,v=document.querySelector("#catalog_groups .current"),h=v&&v.getAttribute("data-groups"),y=document.querySelector(".catalog_categories .current"),c=y&&y.getAttribute("data-category"),a=0,i=r.querySelector("div"),p=n.list.getItemsCategories(),w=n.user.getPinnedCategories(),f,b=function(n,t){var r=t>0?t:n,i=function(){return 42};return r===0?"auto":t>0?t*i()+"px":n>0?(n>3?3:n)*i()+"px":"auto"}(p.length,w.length),k=function(t){return u.getItemsByField(t,"installState",n.enums.install.notInstalled)},l={allDialog:n.localization.getLabel("AllAppPlural"),required:u.getItemsByField("groups","required").length,requiredToInstall:k(u.getItemsByField("groups","required")).length,featured:u.getItemsByField("groups","featured").length,updates:k(u.getItemsByField("groups","updates")).length,blacklisted:u.getItemsByField("groups","blacklisted").length,needsLogout:n.user.requiresAuthentication()&&n.user.get().authenticationType!=="saml",sortPreference:o(),categories:e(p,w),categoriesInitialHeight:b,showMoreCategories:b!=="auto"};t.querySelector(".slider_content").innerHTML=n.templates.getPopulatedHTML("nav_menu_template",l);a=l.blacklisted+l.updates+l.requiredToInstall;a>0?window.requestAnimationFrame(function(){i||(i=document.createElement("div"),i.className="menu_badge");i.innerHTML=a;r.appendChild(i)}):i&&(r.removeChild(i),i=null);h||c||(f=s())&&(document.querySelector('#catalog_groups [data-groups="'+f+'"]')?h=f:document.querySelector('.catalog_categories [data-category="'+f+'"]')&&(c=f));h?document.querySelector('#catalog_groups [data-groups="'+h+'"]').classList.add("current"):c?document.querySelector('.catalog_categories [data-category="'+c+'"]').classList.add("current"):document.querySelector("#catalog_groups li a").classList.add("current")});n.publisher.subscribe("Catalog.sliders.close",function(){t.classList.contains("opened")&&(f(),t.style.webkitTransform="")});r.addEventListener("click",f);i.on("click","#type_selector #type_apps, #type_selector #type_books",function(){var n=document.querySelector("#type_selector .selected");n&&n.classList.remove("selected");this.classList.add("selected");u()});i.on("click",".catalog_sort",function(){this.querySelector("select").focus()});i.on("change",".catalog_sort select",function(){n.storage.currentDevice.set("SORT_PREFERENCE",this.value);u()});i.on("click","#catalog_groups a, .catalog_categories ul a",function(){var r=this.getAttribute("data-groups")||this.getAttribute("data-category"),i=t.querySelector(".current");return i&&i.classList.remove("current"),this.classList.add("current"),n.storage.currentSession.set("LAST_VIEWED_GROUPING",r),u(),!1});i.on("click",".catalog_categories .more",function(){var n=document.querySelector(".catalog_categories");n.querySelector("ul").classList.add("expanded");n.querySelector(".more").style.display="none";n.querySelector(".less").style.display="block"});i.on("click",".catalog_categories .less",function(){var n=document.querySelector(".catalog_categories");n.querySelector("ul").classList.remove("expanded");n.querySelector(".more").style.display="block";n.querySelector(".less").style.display="none"});i.on("click",".logout",function(){return n.publisher.publish("Catalog.sliders.close"),n.loader.show(),n.publisher.publish("Catalog.requestAuthentication"),n.publisher.publish("Catalog.requestToUnauthenticate"),n.loader.hide(),!1});(function(){var i=-100;n.touch.swipeHandler(function(i){t.classList.contains("opened")&&(n.touch.preventDefault(),t.style.webkitTransform=i<0?"translate("+i+"px, 0)":"")},function(n){t.classList.contains("opened")&&(n<i&&f(),requestAnimationFrame(function(){t.style.webkitTransform=""}))})})()});Catalog.ready(function(n){var t=document.getElementById("search"),v=t.querySelector("form"),u=document.getElementById("search_action"),y=new Delegate(u),i=t.querySelector("#search_input"),f=t.querySelector(".search_results"),h=new Delegate(f),c=t.querySelector(".no_search_results"),p=t.querySelector(".slider_close"),e=t.querySelector(".input_clear"),l=document.getElementById("page_container"),o="",s=!1,a=function(){var t,r=i.value.trim().toLowerCase(),u=[],s=n.list.getItemsCategories(),o=[],h="",l="";if(r!==""){for(u=n.list.getItemsByField("name",r,function(n,t){return t.toLowerCase().indexOf(n.toLowerCase())>=0}),n.utils.sortAry(u,"name",!0,function(n){return n.toLowerCase().indexOf(r)}),u.length!==0&&(h+=n.templates.getPopulatedHTML("search_result_count_template",n.localization.getLabel(u.length===1?"ArgItemFound":"ArgItemFoundPlural").format(u.length))),t=0;t<u.length;t++)h+=n.templates.getPopulatedHTML("search_result_item_template",{item:u[t],matchingInput:r,isReviewable:u[t].type!==n.enums.appType.web&&u[t].type!==n.enums.appType.product});e.style.display="block"}else e.style.display="none";if(r!==""){for(t=0;t<s.length;t++)s[t].toLowerCase().indexOf(r)>=0&&o.push(s[t]);n.utils.forEach(document.querySelectorAll("#catalog_groups [data-groups]"),function(n,t){var i=t.getAttribute("data-groups");i.toLowerCase().indexOf(r)>=0&&o.push(i)})}if(o.length!==0)for(n.utils.sortAry(o,!0,function(n){return n.toLowerCase().indexOf(r)}),l+=n.templates.getPopulatedHTML("search_result_count_template",n.localization.getLabel(o.length===1?"ArgCategoryFound":"ArgCategoryFoundPlural").format(o.length)),t=0;t<o.length;t++)l+=n.templates.getPopulatedHTML("search_result_catalog_template",{category:o[t],matchingInput:r});f.innerHTML=h+l;c.style.display=u.length===0&&o.length===0&&r!==""?"block":"none"},r=function(){var r=document.querySelector("#list_view ul .selected a");t.classList.contains("opened")?(i.blur(),i.setAttribute("disabled","disabled"),window.requestAnimationFrame(function(){var i=t.querySelector(".selected");!n.utils.isMobileResolution()&&f.querySelector(".selected")&&(r?n.publisher.publish("Catalog.showDetails",r.getAttribute("data-guid")):n.publisher.publish("Catalog.hideDetails"));l.classList.remove("search_opened");t.classList.remove("opened");u.classList.remove("opened","branded-nav-bg","branded-nav-item");i&&i.classList.remove("selected");n.publisher.publish("Catalog.slider.closed")})):(n.publisher.publish("Catalog.sliders.close"),window.requestAnimationFrame(function(){l.classList.add("search_opened");t.classList.add("opened");t.scrollTop=0;u.classList.add("opened","branded-nav-bg","branded-nav-item");i.removeAttribute("disabled")}),document.querySelector(".slider_bg").classList.add("search_overlay"),n.publisher.publish("Catalog.slider.opened"))};n.publisher.subscribe("Catalog.resize",function(){n.utils.isMobileResolution()&&n.publisher.publish("Catalog.sliders.close")});n.publisher.subscribe("Catalog.sliders.close",function(){var n=document.querySelector(".search_overlay");t.classList.contains("opened")&&(r(),n&&n.classList.remove("search_overlay"))});y.on("click",r);p.addEventListener("click",r);v.addEventListener("submit",function(n){return n.preventDefault(),!1});e.addEventListener("click",function(){i.value="";o="";a();this.style.display="none";i.focus()});i.addEventListener("keyup",function(){var n=i.value;n=n!==undefined?n.trim():n;n!=o&&(a(),o=n);n.toLowerCase()==="aw_logs"&&document.body.classList.toggle("aw_logs")});h.on("click","a",function(){var u=document.getElementById("details_view"),f=this.getAttribute("data-guid"),t=this.parentNode,i=this.textContent.trim(),r=t.parentNode.querySelector(".selected");this.classList.contains("category_result")?document.querySelector('nav .catalog_categories [data-category="'+i+'"]')?n.utils.click(document.querySelector('nav .catalog_categories [data-category="'+i+'"]')):n.utils.click(document.querySelector('#catalog_groups [data-groups="'+i+'"]')):(u.querySelector(".view_body").scrollTop=0,t.classList.contains("selected")||(r&&r.classList.remove("selected"),t.classList.add("selected"),n.publisher.publish("Catalog.showDetails",f),n.utils.isMobileResolution()&&n.publisher.publish("Catalog.sliders.close")))});t.addEventListener("scroll",function(){n.utils.isMobileDevice()&&s&&i.blur()});i.addEventListener("focus",function(){s=!0});i.addEventListener("blur",function(){s=!1});h.on("click","button",function(){return n.installer.install(this.getAttribute("data-install-for")),!1});(function(){var f=100,u=function(n){n>0?(i.blur(),t.style.webkitTransform="translate("+n+"px, 0)"):t.style.webkitTransform=""};n.touch.swipeHandler(function(i,r){t.classList.contains("opened")&&(n.touch.preventDefault(),n.utils.isMobileResolution()?u(i):(t===r||n.utils.isDecendent(t,r))&&u(i))},function(n){t.classList.contains("opened")&&(n>f&&r(),requestAnimationFrame(function(){t.style.webkitTransform=""}))})})()});Catalog.ready(function(n){"use strict";n.publisher.subscribe("Catalog.slider.opened",function(){document.body.classList.add("slider_open")});n.publisher.subscribe("Catalog.slider.closed",function(){document.body.classList.remove("slider_open")});document.querySelector(".slider_bg").addEventListener("click",function(){n.publisher.publish("Catalog.sliders.close")})});Catalog.ready(function(n){var u=document.body,i=document.getElementById("back_action"),e=new Delegate(i),t=document.getElementById("menu_action"),f=document.getElementById("search_action"),r=!1;n.publisher.subscribe("Catalog.home",function(){t.classList.contains("hidden")&&n.utils.click(i)});n.publisher.subscribe("Catalog.headerActionsToggle",function(n){n?(t.classList.remove("hidden"),f.classList.remove("hidden"),u.classList.remove("header_actions_disabled"),r=!0):(t.classList.add("hidden"),i.classList.add("hidden"),f.classList.add("hidden"),u.classList.add("header_actions_disabled"),r=!1)});n.publisher.subscribe("Catalog.back",function(){t.classList.contains("hidden")&&t.classList.remove("hidden");i.classList.add("hidden");n.publisher.publish("Catalog.sliders.close")});e.on("click",function(){n.publisher.publish("Catalog.back")});document.getElementById("logo").addEventListener("click",function(){return r&&(n.publisher.publish("Catalog.home"),n.publisher.publish("Catalog.sliders.close")),!1})});Catalog.ready(function(n){var t=document.getElementById("login"),i=t.querySelector("form"),u=i.querySelector("#username"),o=i.querySelector("#password"),s=i.querySelector("#token"),r=i.querySelector("#login_submit"),h=i.querySelector("#remember_username"),f=t.querySelector(".login_error"),c=function(){r.setAttribute("disabled","disabled");r.value=n.localization.getLabel("LoggingYouIn")},e=function(){r.removeAttribute("disabled");r.value=n.localization.getLabel("Login")},l=function(){switch(n.authenticationType){case n.enums.authType.token1factor:t.querySelector('[data-wrapper="token_wrap"]').classList.remove("hidden");t.querySelector('[data-wrapper="user_pass_wrap"]').classList.add("hidden");break;case n.enums.authType.token2factor:t.querySelector('[data-wrapper="token_wrap"]').classList.remove("hidden");t.querySelector('[data-wrapper="user_pass_wrap"]').classList.remove("hidden");break;case n.enums.authType.forms:default:t.querySelector('[data-wrapper="token_wrap"]').classList.add("hidden");t.querySelector('[data-wrapper="user_pass_wrap"]').classList.remove("hidden")}};n.publisher.subscribe("Catalog.showLogin",function(){var i=n.storage.currentDevice.get("USERNAME");f.style.display="none";i&&i.length>0&&(h.setAttribute("checked","checked"),u.value=i);l();n.publisher.publish("Catalog.headerActionsToggle",!1);t.classList.add("opened");n.utils.forEach(t.querySelectorAll("input"),function(n,t){t.removeAttribute("disabled")})});n.publisher.subscribe("Catalog.hideLogin",function(){t.classList.remove("opened");n.utils.forEach(t.querySelectorAll("input"),function(n,t){t.setAttribute("disabled","disabled")});f.style.display="none"});n.publisher.subscribe("Catalog.showLoginError",function(){f.style.display="block"});i.addEventListener("submit",function(t){t.preventDefault();c();var i=u.value,l=o.value,f=s.value,a=h.checked,r=!1;return(i=n.utils.cleanString(i),f=n.utils.cleanString(f),r||n.authenticationType!==n.enums.authType.forms&&n.authenticationType!==n.enums.authType.token2factor||(i===""||l==="")&&(r=!0,n.publisher.publish("Catalog.failedAuthentication"),e()),r||n.authenticationType!==n.enums.authType.token1factor&&n.authenticationType!==n.enums.authType.token2factor||f===""&&(r=!0,n.publisher.publish("Catalog.failedAuthentication"),e()),r)?!1:(n.authentication.sendCredentials(i,l,f,function(t){t&&(a?n.storage.currentDevice.set("USERNAME",i):n.storage.currentDevice.remove("USERNAME"));u.value="";o.value="";s.value="";e()}),!1)})});Catalog.ready(function(n){var t=document.getElementById("featured"),i=new Delegate(t);n.publisher.subscribe("Catalog.showFeaturedList",function(){var i=document.querySelector(".view.opened"),r,u=function(){document.querySelector("#featured .featured_items").innerHTML=r};r=n.templates.getPopulatedHTML("featured_list_item_template",n.list.getItemsByField("groups","featured"));u();t!==i&&(i.classList.remove("opened"),t.classList.add("opened"));t.querySelector(".view_body").scrollTop=0});i.on("click",".catalog_item_list a",function(){var i=this.getAttribute("data-guid");document.getElementById("list_view").classList.add("opened");n.utils.click(document.querySelector('#list_view li a[data-guid="'+i+'"]'));t.classList.remove("opened");!n.utils.isMobileResolution()});i.on("click",".catalog_item_list button",function(){var t=this.parentNode.querySelector("a").getAttribute("data-guid");return n.installer.install(t),!1})});Catalog.ready(function(n){"use strict";var t={},r=new Delegate(document.getElementById("modals_container")),i=function(n){return"eula_"+n},u=function(t){n.requester.post(n.endpoints.eula(n.utils.resolveDeviceIdentifier(),n.utils.resolveDeviceType()),t,function(){console.info("successful eula acceptance request")},function(){console.error("unsuccessful eula acceptance request")},{type:"json"})},f=function(r){n.modal.pop();t[i(r)]={}};n.publisher.subscribe("Catalog.showEulasThatNeedAccepting",function(){var u=n.list.getItemsByField("eula",function(n){return n&&n.id}),r;n.utils.forEach(u,function(n,r){var f=i(r.eula.id),u;f in t?(u=t[f],u.itemNames.indexOf(r.name)<0&&u.itemNames.push(r.name),u.itemsListKeyValues.push([r.bundleId,r.type].join(":"))):u=t[f]={id:r.eula.id,itemNames:[r.name],itemsListKeyValues:[[r.bundleId,r.type].join(":")],preInstallEula:!1};r.eula.content&&(u.content=r.eula.content,u.contentId=r.eula.contentId,u.version=r.eula.version);r.eula={}});for(r in t)r=t[r],n.publisher.publish("Catalog.requireEulaAcceptance",r)});n.publisher.subscribe("Catalog.requireEulaAcceptance",function(t){t.title=n.localization.getLabel("EulaForArg").format(t.itemNames.join(", "));n.modal.show(n.templates.getPopulatedHTML("eulas_template",t),{allowOverlayClickClose:!1,modalContentClass:"full_height"})});n.publisher.subscribe("Catalog.requireEulaForInstall",function(r){var u={itemGuid:r.itemGuid,id:r.eulaId,itemNames:[r.itemName],itemsListKeyValues:[],content:r.eulaContent,contentId:r.eulaContentId,version:r.eulaVersion,preInstallEula:!0};t[i(u.id)]=u;n.publisher.publish("Catalog.requireEulaAcceptance",u)});r.on("click",'[data-eula-action="accept"]',function(){var o=this.getAttribute("data-eula-id"),e=i(o),r=t[e];u({eulaId:r.id,eulaContentId:r.contentId,enrollmentUserId:n.user.get().id,eulaVersion:r.version,accepted:!0});r.preInstallEula&&r.itemGuid&&n.installer.install(r.itemGuid,!0);f(e)},!0);r.on("click",'[data-eula-action="decline"]',function(){var o=this.getAttribute("data-eula-id"),e=i(o),r=t[e];if(!r.preInstallEula){if(!confirm(n.localization.getLabel("DeclineAppCatalogUserAgreementDisclaimer")))return;u({eulaId:r.id,eulaContentId:r.contentId,enrollmentUserId:n.user.get().id,eulaVersion:r.version,accepted:!1,bundleTypeKeyValue:r.itemsListKeyValues.join(",")})}f(e)},!0)});Catalog.ready(function(n){n.publisher.subscribe("Catalog.presentManagedDistributionInvitation",function(t){var i={title:t.vppInviteTitle,message:t.vppInviteMessage,inviteUrl:t.vppInviteUrl};n.modal.show(n.templates.getPopulatedHTML("managed_distribution_invites_template",i),{allowOverlayClickClose:!0})})});Handlebars.registerHelper("labelMatchHighlightHelper",function(n,t){"use strict";for(var i=0,u=n.toLowerCase(),r;(i=u.indexOf(t,i))>-1;)r="<em>"+n.substr(i,t.length)+"<\/em>",n=n.substr(0,i)+r+n.substr(i+t.length),u=n.toLowerCase(),i+=r.length;return new Handlebars.SafeString(n)});Handlebars.registerHelper("installButtonHelper",function(n){"use strict";var t="";if(n.activationUrl)t='<button class="install" data-install-for="'+n.guid+'">'+Catalog.utils.getInstallButtonMessage("activate")+"<\/button>";else if(n.groups.indexOf("updates")>=0)t='<button class="install dark_blue" data-install-for="'+n.guid+'">'+Catalog.utils.getInstallButtonMessage("updates")+"<\/button>";else switch(n.installState){case"install":case 1:t='<button class="install" data-install-for="'+n.guid+'">'+Catalog.utils.getInstallButtonMessage(n.installState)+"<\/button>";break;case"pending":case 2:t='<button class="install dark" data-install-for="'+n.guid+'">'+Catalog.utils.getInstallButtonMessage(n.installState)+"<\/button>";break;case"installed":case 3:t='<button class="install green" data-install-for="'+n.guid+'">'+Catalog.utils.getInstallButtonMessage(n.installState)+"<\/button>";break;case"error":case 4:t='<button class="install red" data-install-for="'+n.guid+'">'+Catalog.utils.getInstallButtonMessage(n.installState)+"<\/button>";break;default:console.log("handlebars helper button Helper received an unrecognized state: ",n.installState);t='<button class="install" data-install-for="'+n.guid+'">'+Catalog.utils.getInstallButtonMessage(n.installState)+"<\/button>"}return new Handlebars.SafeString(t)});Handlebars.registerHelper("selectOptionHelper",function(n,t,i,r){"use strict";var u='<option value="'+n+'" ';return n===i&&(u+=" selected "),r&&(u+=r),u+=">"+t+"<\/option>",new Handlebars.SafeString(u)});Handlebars.registerHelper("ratingStarsHelper",function(n){"use strict";for(var i="",t=1;t<=5;t++)i+=t<=n?'<img src="'+Catalog.baseUrl+'Assets/images/star-yellow-sm.png" />':'<img src="'+Catalog.baseUrl+'Assets/images/star-grey-sm.png" />';return new Handlebars.SafeString(i)});Handlebars.registerHelper("screenshotsHelper",function(n,t){"use strict";for(var r="",i=0;i<n.length;i++)r+=t?'<img data-lazy-img-src="'+n[i]+'" />':'<img src="'+n[i]+'" />';return new Handlebars.SafeString(r)});Handlebars.registerHelper("evenClassHelper",function(n){"use strict";return new Handlebars.SafeString(++n%2==0?'class="even"':"")});Handlebars.registerHelper("showFilteredMetaData",function(n,t){"use strict";return t[n]?new Handlebars.SafeString(t[n]):""})